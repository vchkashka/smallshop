{% extends 'base.html' %}
{% load static %}


{% block content %}
<link rel="stylesheet" href="{% static 'core/css/style.css' %}">

<div class="product-detail">
    <div class="product-detail-wrapper">
        {% if product.image and product.image.url %}
            <img src="{{ product.image.url }}" alt="{{ product.title }}" class="product-image">
        {% endif %}

        <div class="product-info">
            <div class="product-title-container">
                <h1 class="product-title">{{ product.title }}</h1>
                {% if perms.products.can_mark_featured %}
                <form method="post" action="{% url 'add_to_favorites' product.slug %}">
                    {% csrf_token %}
                    {% if user.is_authenticated %}
                        {% if user in product.favorites.all %}
                            <button type="submit" class="favorite-btn-detail" title="–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ"
                                    formaction="{% url 'remove_from_favorites' product.slug %}">‚ù§Ô∏è</button>
                        {% else %}
                            <button type="submit" class="favorite-btn-detail" title="–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">ü§ç</button>
                        {% endif %}
                    {% endif %}
                {% endif %}
                </form>
            </div>

            {% block breadcrumbs %} 
                {% with product.tags.all as tags %} 
                    {% if tags %} 
                        <ul class="tags-list"> 
                            {% for t in tags %} 
                            <li><a 
                        href="{{t.get_absolute_url}}">{{t.name}}</a></li> 
                            {% endfor %} 
                        </ul>
                    {% endif %} 
                {% endwith %} 
            {% endblock %}
            <div class="product-description">
                {{ product.content|linebreaks }}
            </div>

            {% if product.seller %}
                {% if request.user != product.seller %}
                    <p class="product-seller">
                        –ü—Ä–æ–¥–∞–≤–µ—Ü:
                        <a href="{% url 'users:public_profile' product.seller.pk %}">
                            {{ product.seller.username }}
                        </a>
                    </p>
                {% endif %}
            {% endif %}

            {% if product.price %}
                <p class="product-price">–¶–µ–Ω–∞: {{ product.price }} ‚ÇΩ</p>
            {% endif %}

            <div class="btn-group">
                {% if perms.products.change_product and request.user == product.seller %}
                    <a href="{% url 'edit_product' product.slug %}" class="btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                {% endif %}

                {% if perms.products.delete_product and request.user == product.seller %}
                    <form method="get" action="{% url 'delete_product' product.slug %}">
                    {% csrf_token %}
                    <button class="btn-delete">–£–¥–∞–ª–∏—Ç—å</button>
                    </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
