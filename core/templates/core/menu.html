<div class="menu-wrapper">
    <div class="arrow left" onclick="scrollMenu(-200)">&#10094;</div>
    <ul id="mainmenu" class="mainmenu">
        <li class="logo"><a href="{% url 'home' %}"><div class="logo"></div></a></li>
        {% for m in menu %}
            <li><a href="{% url m.url_name %}">{{ m.title }}</a></li>
        {% endfor %}

        {% if user.is_authenticated %}
            {% if perms.products.can_mark_featured %} 
                <li><a href="{% url 'favorite_products' %}">Избранное</a></li>
            {% endif %}

            {% if perms.products.add_product %} 
                <li><a href="{% url 'add_product' %}">Добавить товар</a></li>
            {% endif %}

            {% if perms.products.add_category and perms.products.add_tagproduct %} 
                <li><a href="{% url 'manage_categories' %}">Управление категориями</a></li>
            {% endif %}

            <li>
                <a href="{% url 'users:profile' %}">{{ user.username }}</a>
                <span class="line">| </span> 
                <a href="{% url 'users:logout' %}">Выйти</a>
            </li>
        {% else %} 
            <li>
                <a href="{% url 'users:login' %}">Войти</a>
                <span class="line"> | </span> 
                <a href="{% url 'users:register' %}">Регистрация</a>
            </li>
        {% endif %}
    </ul>
    <div class="arrow right" onclick="scrollMenu(200)">&#10095;</div>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const menu = document.querySelector(".mainmenu");
    const arrowLeft = document.querySelector(".arrow.left");
    const arrowRight = document.querySelector(".arrow.right");

    function updateArrows() {
        const scrollLeft = menu.scrollLeft;
        const maxScroll = menu.scrollWidth - menu.clientWidth;

        arrowLeft.style.display = scrollLeft > 0 ? "flex" : "none";
        arrowRight.style.display = scrollLeft < maxScroll ? "flex" : "none";
    }

    arrowLeft.addEventListener("click", () => {
        menu.scrollBy({ left: -200, behavior: "smooth" });
    });

    arrowRight.addEventListener("click", () => {
        menu.scrollBy({ left: 200, behavior: "smooth" });
    });

    menu.addEventListener("scroll", updateArrows);
    window.addEventListener("resize", updateArrows);

    updateArrows(); // Initial check
});
</script>
